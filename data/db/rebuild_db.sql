
 

DROP DATABASE IF EXISTS GOHIRE_INTERVIEW;
CREATE DATABASE GOHIRE_INTERVIEW;

 

use GOHIRE_INTERVIEW;

CREATE TABLE EMPLOYERS (EMPLOYER_ID INT AUTO_INCREMENT NOT NULL, EMPLOYER_NAME VARCHAR(255) NOT NULL, STREET VARCHAR(100) DEFAULT NULL, CITY VARCHAR(100) DEFAULT NULL, STATE VARCHAR(100) DEFAULT NULL, ZIP_CODE VARCHAR(10) DEFAULT NULL, COUNTRY VARCHAR(100) DEFAULT NULL, DATETIME_CREATED DATETIME NOT NULL, DATETIME_MODIFIED DATETIME DEFAULT NULL, PRIMARY KEY(EMPLOYER_ID)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE USER_EMPLOYERS (FK_EMPLOYER_ID INT NOT NULL, FK_USER_ID INT NOT NULL, INDEX IDX_1B94B39FE36FD56B (FK_EMPLOYER_ID), INDEX IDX_1B94B39F9DE5D730 (FK_USER_ID), PRIMARY KEY(FK_EMPLOYER_ID, FK_USER_ID)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE JOB_ALERTS (JOB_ALERT_ID INT AUTO_INCREMENT NOT NULL, SETTING_JSON LONGTEXT NOT NULL, ENABLED_FLAG VARCHAR(1) NOT NULL, DATETIME_CREATED DATETIME NOT NULL, DATETIME_MODIFIED DATETIME DEFAULT NULL, FK_JOB_SEEKER_ID INT DEFAULT NULL, INDEX IDX_635CC9496829CD57 (FK_JOB_SEEKER_ID), PRIMARY KEY(JOB_ALERT_ID)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE JOB_SEEKERS (JOB_SEEKER_ID INT AUTO_INCREMENT NOT NULL, FK_USER_ID INT DEFAULT NULL, INDEX IDX_D1A376029DE5D730 (FK_USER_ID), PRIMARY KEY(JOB_SEEKER_ID)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE USERS (USER_ID INT AUTO_INCREMENT NOT NULL, FIRST_NAME VARCHAR(255) NOT NULL, LAST_NAME VARCHAR(100) NOT NULL, EMAIL VARCHAR(100) NOT NULL, STREET VARCHAR(100) DEFAULT NULL, CITY VARCHAR(100) DEFAULT NULL, STATE VARCHAR(100) DEFAULT NULL, ZIP_CODE VARCHAR(10) DEFAULT NULL, DATETIME_LAST_LOGIN DATETIME DEFAULT NULL, DATETIME_CREATED DATETIME NOT NULL, DATETIME_MODIFIED DATETIME DEFAULT NULL, LOCKED_FLAG VARCHAR(1) NOT NULL, DELETED_FLAG VARCHAR(1) NOT NULL, FK_CURRENT_EMPLOYER_ID INT DEFAULT NULL, INDEX IDX_E3D7675937E4D705 (FK_CURRENT_EMPLOYER_ID), PRIMARY KEY(USER_ID)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE USER_AUTHENTICATIONS (USER_AUTHENTICATION_ID INT AUTO_INCREMENT NOT NULL, AUTHENTICATION_PROVIDER VARCHAR(100) NOT NULL, USER_NAME VARCHAR(100) NOT NULL, PASSWORD VARCHAR(1000) DEFAULT NULL, DATETIME_CREATED DATETIME NOT NULL, DATETIME_MODIFIED DATETIME DEFAULT NULL, FK_USER_ID INT NOT NULL, INDEX IDX_E650719A9DE5D730 (FK_USER_ID), PRIMARY KEY(USER_AUTHENTICATION_ID)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE USER_JOB_CLICKS (USER_JOB_CLICK_ID INT AUTO_INCREMENT NOT NULL, JOB_JSON LONGTEXT NOT NULL, DATETIME_CREATED DATETIME NOT NULL, FK_USER_SEARCH_HISTORY_ID INT NOT NULL, INDEX IDX_FD750084B6443943 (FK_USER_SEARCH_HISTORY_ID), PRIMARY KEY(USER_JOB_CLICK_ID)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE USER_LOGIN_AUDIT (USER_LOGIN_AUDIT_ID INT AUTO_INCREMENT NOT NULL, DATETIME_LOGIN DATETIME NOT NULL, LOGIN_SUCCESS_FLAG VARCHAR(1) NOT NULL, FK_USER_AUTHENTICATION_ID INT NOT NULL, INDEX IDX_563C1068FB023CD3 (FK_USER_AUTHENTICATION_ID), PRIMARY KEY(USER_LOGIN_AUDIT_ID)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE USER_SEARCH_HISTORY (USER_SEARCH_HISTORY_ID INT AUTO_INCREMENT NOT NULL, KEYWORD VARCHAR(255) NOT NULL, DATETIME_CREATED DATETIME NOT NULL, FK_USER_ID INT NOT NULL, INDEX IDX_91EEDF409DE5D730 (FK_USER_ID), PRIMARY KEY(USER_SEARCH_HISTORY_ID)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE VISITS (VISIT_ID INT AUTO_INCREMENT NOT NULL, IP VARCHAR(50) NOT NULL, USER_AGENT VARCHAR(500) NOT NULL, REFERENCE_URL VARCHAR(500) NOT NULL, refPromoCode VARCHAR(100) NOT NULL, DATETIME_CREATED DATETIME NOT NULL, PRIMARY KEY(VISIT_ID)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
ALTER TABLE USER_EMPLOYERS ADD CONSTRAINT FK_1B94B39FE36FD56B FOREIGN KEY (FK_EMPLOYER_ID) REFERENCES EMPLOYERS (EMPLOYER_ID);
ALTER TABLE USER_EMPLOYERS ADD CONSTRAINT FK_1B94B39F9DE5D730 FOREIGN KEY (FK_USER_ID) REFERENCES USERS (USER_ID);
ALTER TABLE JOB_ALERTS ADD CONSTRAINT FK_635CC9496829CD57 FOREIGN KEY (FK_JOB_SEEKER_ID) REFERENCES JOB_SEEKERS (JOB_SEEKER_ID);
ALTER TABLE JOB_SEEKERS ADD CONSTRAINT FK_D1A376029DE5D730 FOREIGN KEY (FK_USER_ID) REFERENCES USERS (USER_ID);
ALTER TABLE USERS ADD CONSTRAINT FK_E3D7675937E4D705 FOREIGN KEY (FK_CURRENT_EMPLOYER_ID) REFERENCES EMPLOYERS (EMPLOYER_ID);
ALTER TABLE USER_AUTHENTICATIONS ADD CONSTRAINT FK_E650719A9DE5D730 FOREIGN KEY (FK_USER_ID) REFERENCES USERS (USER_ID);
ALTER TABLE USER_JOB_CLICKS ADD CONSTRAINT FK_FD750084B6443943 FOREIGN KEY (FK_USER_SEARCH_HISTORY_ID) REFERENCES USER_SEARCH_HISTORY (USER_SEARCH_HISTORY_ID);
ALTER TABLE USER_LOGIN_AUDIT ADD CONSTRAINT FK_563C1068FB023CD3 FOREIGN KEY (FK_USER_AUTHENTICATION_ID) REFERENCES USER_AUTHENTICATIONS (USER_AUTHENTICATION_ID);
ALTER TABLE USER_SEARCH_HISTORY ADD CONSTRAINT FK_91EEDF409DE5D730 FOREIGN KEY (FK_USER_ID) REFERENCES USERS (USER_ID);
ALTER TABLE USER_LOGIN_AUDIT ADD USER_NAME VARCHAR(255) DEFAULT NULL, CHANGE FK_USER_AUTHENTICATION_ID FK_USER_AUTHENTICATION_ID INT DEFAULT NULL;
ALTER TABLE USER_SEARCH_HISTORY CHANGE FK_USER_ID FK_USER_ID INT DEFAULT NULL;

ALTER TABLE USERS ADD USER_TYPE VARCHAR(10) DEFAULT NULL;
ALTER TABLE USERS CHANGE USER_TYPE USER_TYPE VARCHAR(10) NOT NULL;
ALTER TABLE `USER_AUTHENTICATIONS` ADD `RESET_TOKEN` VARCHAR( 15 ) NULL AFTER `PASSWORD` ;

CREATE TABLE GEO_NAME
(
Country varchar(2)	DEFAULT NULL,
Zipcode	varchar(20) DEFAULT NULL,
CityName varchar(180) DEFAULT NULL,
StateName	VARCHAR(100) DEFAULT NULL,
StateCode	VARCHAR(20) DEFAULT NULL,
CountyName	VARCHAR(100) DEFAULT NULL,
CountyCode	VARCHAR(20) DEFAULT NULL,
CommunityName	VARCHAR(100) DEFAULT NULL,
CommunityCode	VARCHAR(20) DEFAULT NULL,
latitude	decimal(18,9) default NULL,
longitude	decimal(18,9) default NULL,
Accuracy  INT,
GEO_ID INT AUTO_INCREMENT NOT NULL, 
PRIMARY KEY(GEO_ID)
) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;

-- This to to capture the Subscriber_ID returned back from Zip Alert API
ALTER TABLE JOB_SEEKERS ADD SUBSCRIBER_ID VARCHAR(20) NULL;
ALTER TABLE JOB_ALERTS add SEARCH_ID varchar(20) null;

-- This to capture jobseekers data
ALTER TABLE `job_seekers` ADD `PHONE_NO` VARCHAR( 15 ) NULL ,
ADD `INDUSTRY` INT NULL ,
ADD `HEADLINE` VARCHAR( 500 ) NULL ,
ADD `EXPERIENCE` INT NULL ,
ADD `EDUCATION` INT NULL ,
ADD `DESIRED_SALARY` INT NULL ,
ADD `COUNTRY` INT NULL ,
ADD `ZIP_CODE` VARCHAR( 10 ) NULL ,
ADD `LINKEDIN` VARCHAR( 500 ) NULL ,
ADD `TWITTER` VARCHAR( 500 ) NULL ,
ADD `FACEBOOK` VARCHAR( 500 ) NULL ,
ADD `COMPANY_FIND_FLAG` VARCHAR( 1 ) NULL ;

-- Add a new table into DB, called URLTemplates
CREATE TABLE URL_TEMPLATES (
   `URLID` bigint(20) DEFAULT NULL,
   `URL` varchar(256) DEFAULT NULL,
   `TEMPLATEID` int(11) DEFAULT NULL,
   `ACTIVE` tinyint(4) DEFAULT NULL,
   `SUB_DOMAIN_ID` int(11) DEFAULT NULL,
   `SITEDOMAIN` varchar(100) DEFAULT NULL,
   `GOOGLEPRIORITY` smallint(6) DEFAULT NULL,
   `GJQ` varchar(256) DEFAULT NULL,
   `GJL` varchar(256) DEFAULT NULL,
   `GJJOBCATEGORY` varchar(10) DEFAULT NULL,
   `INDEEDQ` varchar(256) DEFAULT NULL,
   `INDEEDL` varchar(256) DEFAULT NULL,
   `INDEEDFROMAGE` smallint(6) DEFAULT NULL,
   `INDEEDHIGHLIGHT` tinyint(4) DEFAULT NULL,
   `INDEEDCHANNEL` varchar(50) DEFAULT NULL,
   `SEARCHTYPE` varchar(50) DEFAULT NULL,
   `ZIPCODE` varchar(12) DEFAULT NULL,
   `RESULTTYPE` smallint(6) DEFAULT NULL,
   `PAGE_TITLE` varchar(384) DEFAULT NULL,
   `PAGE_META_KEYWORDS` varchar(512) DEFAULT NULL,
   `PAGE_META_DESCRIPTION` varchar(512) DEFAULT NULL,
   `PRIMARY_KEYWORD_PHRASE` varchar(128) DEFAULT NULL,
   `TEXTAREA1` varchar(256) DEFAULT NULL,
   `TEXTAREA2` varchar(256) DEFAULT NULL,
   `TEXTAREA3` varchar(256) DEFAULT NULL,
   `TEXTAREA4` varchar(256) DEFAULT NULL,
   `TEXTAREA5` varchar(256) DEFAULT NULL,
   `TEXT_H1A` varchar(384) DEFAULT NULL, 
   `TEXTH1B` varchar(512) DEFAULT NULL,
   `TEXTH2A` varchar(100) DEFAULT NULL,
   `TEXTH2B` varchar(256) DEFAULT NULL,
   `NAVTEXT1` varchar(128) DEFAULT NULL,
   `NAVKEYWORD1` varchar(50) DEFAULT NULL,
   `NAVTEXT2` varchar(128) DEFAULT NULL,
   `NAVKEYWORD2` varchar(50) DEFAULT NULL,
   `RSSFEEDLINK` varchar(256) DEFAULT NULL,
   `RSSFEEDTEXT` varchar(128) DEFAULT NULL,
   `TWITTERLINK` tinyint(4) DEFAULT NULL,
   `ARTICLES` tinyint(4) DEFAULT NULL,
   `VIDEOURLLINK` varchar(150) DEFAULT NULL,
   `VIDEOTHUMBNAIL` varchar(150) DEFAULT NULL,
   `VIDEODESCRIPTION` varchar(100) DEFAULT NULL,
   `VIDEOLOGO` varchar(150) DEFAULT NULL,
   `PAGELOGO` varchar(100) DEFAULT NULL,
   `PAGECSS` varchar(100) DEFAULT NULL,
   `SITEMAPFILE` varchar(50) DEFAULT NULL,
   `INCLUDEINBROWSE` smallint(6) DEFAULT NULL,
   `BROWSEFUNCTIONKEYWORD` varchar(50) DEFAULT NULL,
   `BROWSELOCATIONKEYWORD` varchar(50) DEFAULT NULL,
   `CREATEDDATE` datetime DEFAULT NULL,
   `MODIFIEDDATE` datetime DEFAULT NULL,
	`LANDING_PAGE` varchar(100) COLLATE utf8_unicode_ci DEFAULT NULL
 )  ENGINE=InnoDB  DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci ;

load data local infile 'C:/MyProjects/interview/data/db/sample.txt ' into table URL_TEMPLATES fields terminated by '\t' lines terminated by '\n';
 




